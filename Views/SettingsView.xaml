<Window x:Class="ETAG_ERP.Views.SettingsView"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="الإعدادات"
        Height="800" Width="1300"
        FlowDirection="RightToLeft" 
        FontFamily="Segoe UI"
        WindowStartupLocation="CenterScreen"
        Background="#f5f6fa">

    <Grid Margin="10" Background="#f5f6fa">

        <!-- TabControl عصري مع ألوان متدرجة -->
        <TabControl FontSize="14" Background="White" BorderThickness="0" 
                    Margin="0" Padding="0">
            <TabControl.Resources>
                <Style TargetType="TabItem">
                    <Setter Property="Padding" Value="15,8"/>
                    <Setter Property="Margin" Value="2"/>
                    <Setter Property="Background" Value="#3498db"/>
                    <Setter Property="Foreground" Value="White"/>
                    <Setter Property="FontWeight" Value="Bold"/>
                    <Setter Property="BorderBrush" Value="#2980b9"/>
                    <Setter Property="BorderThickness" Value="1"/>
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="TabItem">
                                <Border Name="Bd" Background="{TemplateBinding Background}" 
                                        BorderBrush="{TemplateBinding BorderBrush}" BorderThickness="{TemplateBinding BorderThickness}" 
                                        CornerRadius="5,5,0,0" Padding="{TemplateBinding Padding}">
                                    <ContentPresenter x:Name="Content" ContentSource="Header" HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                                <ControlTemplate.Triggers>
                                    <Trigger Property="IsSelected" Value="True">
                                        <Setter TargetName="Bd" Property="Background" Value="#2c3e50"/>
                                        <Setter Property="Foreground" Value="White"/>
                                    </Trigger>
                                    <Trigger Property="IsMouseOver" Value="True">
                                        <Setter TargetName="Bd" Property="Background" Value="#2980b9"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </TabControl.Resources>

            <!-- 1️⃣ الإعدادات العامة -->
            <TabItem Header="🏢 الإعدادات العامة">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20" Width="650">

                        <GroupBox Header="قاعدة البيانات" FontWeight="Bold" Margin="0,0,0,20">
                            <StackPanel Margin="10">
                                <Button Content="🔄 إعادة إنشاء قاعدة البيانات" Height="40" Width="300"
                                        Click="ResetDatabase_Click" Background="#e74c3c" Foreground="White" Margin="0,0,0,10"/>
                                <TextBlock Text="مسار قاعدة البيانات:" Margin="0,10,0,5" Foreground="Black"/>
                                <TextBox x:Name="txtDatabasePath" IsReadOnly="True" Height="30"/>
                                <Button Content="📂 تغيير المسار" Width="300" Height="35" Click="ChangeDatabasePath_Click" Margin="0,10,0,0"/>
                            </StackPanel>
                        </GroupBox>

                        <GroupBox Header="بيانات الشركة والفروع" FontWeight="Bold">
                            <StackPanel Margin="10">
                                <TextBlock Text="اسم الشركة:" Foreground="Black"/>
                                <TextBox x:Name="txtCompanyName" Height="30"/>
                                <TextBlock Text="العنوان:" Margin="0,10,0,0" Foreground="Black"/>
                                <TextBox x:Name="txtCompanyAddress" Height="30"/>
                                <TextBlock Text="الهاتف:" Margin="0,10,0,0" Foreground="Black"/>
                                <TextBox x:Name="txtCompanyPhone" Height="30"/>
                                <TextBlock Text="البريد الإلكتروني:" Margin="0,10,0,0" Foreground="Black"/>
                                <TextBox x:Name="txtCompanyEmail" Height="30"/>

                                <TextBlock Text="الفروع / المخازن / الورش:" FontWeight="Bold" Margin="0,10,0,5"/>
                                <DataGrid x:Name="BranchesDataGrid" AutoGenerateColumns="False" CanUserAddRows="False" Height="150" SelectionChanged="BranchesDataGrid_SelectionChanged">
                                    <DataGrid.Columns>
                                        <DataGridTextColumn Header="الاسم" Binding="{Binding Name}" Width="*"/>
                                        <DataGridTextColumn Header="النوع" Binding="{Binding Type}" Width="*"/>
                                        <DataGridTextColumn Header="الموقع" Binding="{Binding Location}" Width="*"/>
                                        <DataGridCheckBoxColumn Header="نشط" Binding="{Binding IsActive}" Width="80"/>
                                        <DataGridTemplateColumn Header="تحكم" Width="150">
                                            <DataGridTemplateColumn.CellTemplate>
                                                <DataTemplate>
                                                    <StackPanel Orientation="Horizontal">
                                                        <Button Content="🖉" Click="EditBranch_Click" Width="50" Margin="2"/>
                                                        <Button Content="🗑" Click="DeleteBranch_Click" Width="50" Margin="2"/>
                                                    </StackPanel>
                                                </DataTemplate>
                                            </DataGridTemplateColumn.CellTemplate>
                                        </DataGridTemplateColumn>
                                    </DataGrid.Columns>
                                </DataGrid>
                                <Button Content="➕ إضافة فرع / مخزن / ورشة" Width="250" Height="35" Click="AddBranch_Click" Margin="0,10,0,0"/>
                                <Button Content="💾 حفظ الإعدادات" Width="250" Height="35" Background="#27ae60" Foreground="White" Margin="0,10,0,0" Click="SaveGeneralSettings_Click"/>
                            </StackPanel>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
            <!-- 2️⃣ المستخدمون والموظفون -->
            <TabItem Header="المستخدمون والموظفون">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="450"/>
                    </Grid.ColumnDefinitions>

                    <!-- Users -->
                    <GroupBox Header="المستخدمون" FontWeight="Bold" Grid.Column="0" Margin="0,0,10,0">
                        <StackPanel Margin="10">
                            <DataGrid x:Name="UsersDataGrid" AutoGenerateColumns="False" CanUserAddRows="False" IsReadOnly="True" Height="350">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="اسم المستخدم" Binding="{Binding Username}" Width="*"/>
                                    <DataGridTextColumn Header="الاسم الكامل" Binding="{Binding FullName}" Width="*"/>
                                    <DataGridTextColumn Header="الدور" Binding="{Binding Role}" Width="*"/>
                                    <DataGridTemplateColumn Header="تحكم" Width="120">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                    <Button Content="🖉" Click="EditUser_Click" Width="50" Margin="2"/>
                                                    <Button Content="🗑" Click="DeleteUser_Click" Width="50" Margin="2"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            <Button Content="إضافة مستخدم" Width="150" Height="35" Click="AddUser_Click" Margin="0,10,0,0"/>
                        </StackPanel>
                    </GroupBox>

                    <!-- Employees -->
                    <GroupBox Header="الموظفون / المندوبون" FontWeight="Bold" Grid.Column="1">
                        <StackPanel Margin="10">
                            <DataGrid x:Name="EmployeesDataGrid" AutoGenerateColumns="False" CanUserAddRows="False" IsReadOnly="True" Height="350">
                                <DataGrid.Columns>
                                    <DataGridTextColumn Header="الاسم" Binding="{Binding Name}" Width="*"/>
                                    <DataGridTextColumn Header="الوظيفة" Binding="{Binding Job}" Width="*"/>
                                    <DataGridTextColumn Header="الهاتف" Binding="{Binding Phone}" Width="*"/>
                                    <DataGridTemplateColumn Header="تحكم" Width="120">
                                        <DataGridTemplateColumn.CellTemplate>
                                            <DataTemplate>
                                                <StackPanel Orientation="Horizontal">
                                                    <Button Content="🖉" Click="EditEmployee_Click" Width="50" Margin="2"/>
                                                    <Button Content="🗑" Click="DeleteEmployee_Click" Width="50" Margin="2"/>
                                                </StackPanel>
                                            </DataTemplate>
                                        </DataGridTemplateColumn.CellTemplate>
                                    </DataGridTemplateColumn>
                                </DataGrid.Columns>
                            </DataGrid>
                            <Button Content="إضافة موظف / مندوب" Width="150" Height="35" Click="AddEmployee_Click" Margin="0,10,0,0"/>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- 3️⃣ صلاحيات المستخدمين -->
            <TabItem Header="صلاحيات المستخدمين">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <TextBlock Text="اختر المستخدم:" FontWeight="Bold"/>
                        <ComboBox x:Name="cmbUsersPermissions" Width="300" Margin="0,5,0,10"/>
                        <TreeView x:Name="PermissionsTreeView"/>
                        <Button Content="حفظ الصلاحيات" Width="150" Height="35" Margin="0,10,0,0" Click="SavePermissions_Click" Background="#4CAF50" Foreground="White"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- 4️⃣ الوسائط والطباعة والتصدير -->
            <TabItem Header="الوسائط والطباعة والتصدير">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="10">
                        <TextBlock Text="الصور" FontWeight="Bold" FontSize="16" Margin="0,0,0,10"/>
                        <Button Content="رفع صورة خلفية عامة" Width="250" Height="35" Click="UploadBackgroundImage_Click" Margin="0,0,0,10"/>
                        <Button Content="رفع صور المنتجات" Width="250" Height="35" Click="UploadProductImages_Click" Margin="0,0,0,10"/>
                        <TextBlock Text="استيراد / تصدير البيانات" FontWeight="Bold" FontSize="16" Margin="0,20,0,10"/>
                        <Button Content="استيراد بيانات العملاء" Width="250" Height="35" Click="ImportClients_Click" Margin="0,0,0,10"/>
                        <Button Content="استيراد بيانات الأصناف" Width="250" Height="35" Click="ImportItems_Click" Margin="0,0,0,10"/>
                        <Button Content="تصدير جميع البيانات" Width="250" Height="35" Click="ExportAllData_Click" Margin="0,0,0,10"/>
                        <TextBlock Text="إدارة الطباعة والنماذج" FontWeight="Bold" FontSize="16" Margin="0,20,0,10"/>
                        <Button Content="رفع نموذج طباعة جديد" Width="250" Height="35" Click="UploadPrintTemplate_Click" Margin="0,0,0,10"/>
                        <Button Content="اختيار الطابعة الافتراضية" Width="250" Height="35" Click="ChooseDefaultPrinter_Click" Margin="0,0,0,10"/>
                        <Button Content="معاينة الطباعة" Width="250" Height="35" Click="PreviewPrint_Click"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

            <!-- 5️⃣ إدارة التصنيفات -->
            <TabItem Header="إدارة التصنيفات">
                <Grid Margin="10">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="300"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <TreeView x:Name="CategoryTreeView" Grid.Column="0" Margin="0,0,10,0"/>
                    <StackPanel Grid.Column="1" VerticalAlignment="Top">
                        <TextBlock Text="التصنيفات الهرمية" FontWeight="Bold" FontSize="16" Margin="0,0,0,10"/>
                        <UniformGrid Columns="3" Rows="5" Margin="0,0,0,10">
                            <Button Content="إضافة Family" Click="AddFamily_Click" Height="35" Margin="3"/>
                            <Button Content="تعديل Family" Click="EditFamily_Click" Height="35" Margin="3"/>
                            <Button Content="حذف Family" Click="DeleteFamily_Click" Height="35" Margin="3"/>
                            <Button Content="إضافة SubFamily" Click="AddSubFamily_Click" Height="35" Margin="3"/>
                            <Button Content="تعديل SubFamily" Click="EditSubFamily_Click" Height="35" Margin="3"/>
                            <Button Content="حذف SubFamily" Click="DeleteSubFamily_Click" Height="35" Margin="3"/>
                            <Button Content="إضافة SubSubFamily" Click="AddSubSubFamily_Click" Height="35" Margin="3"/>
                            <Button Content="تعديل SubSubFamily" Click="EditSubSubFamily_Click" Height="35" Margin="3"/>
                            <Button Content="حذف SubSubFamily" Click="DeleteSubSubFamily_Click" Height="35" Margin="3"/>
                            <Button Content="إضافة SubSubSubFamily" Click="AddSubSubSubFamily_Click" Height="35" Margin="3"/>
                            <Button Content="تعديل SubSubSubFamily" Click="EditSubSubSubFamily_Click" Height="35" Margin="3"/>
                            <Button Content="حذف SubSubSubFamily" Click="DeleteSubSubSubFamily_Click" Height="35" Margin="3"/>
                            <Button Content="إضافة SubSubSubSubFamily" Click="AddSubSubSubSubFamily_Click" Height="35" Margin="3"/>
                            <Button Content="تعديل SubSubSubSubFamily" Click="EditSubSubSubSubFamily_Click" Height="35" Margin="3"/>
                            <Button Content="حذف SubSubSubSubFamily" Click="DeleteSubSubSubSubFamily_Click" Height="35" Margin="3"/>
                        </UniformGrid>
                        <Button Content="حفظ التعديلات" Width="150" Height="35" Click="SaveCategories_Click" Background="#4CAF50" Foreground="White"/>
                    </StackPanel>
                </Grid>
            </TabItem>

            <!-- 6️⃣ إعدادات المحاسبة / الخزنة -->
            <TabItem Header="إعدادات الحسابات والخزنة">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="20">
                        <TextBlock Text="إعدادات الحسابات والخزنة" FontWeight="Bold" FontSize="16" Margin="0,0,0,10"/>
                        <StackPanel Orientation="Horizontal" Margin="0,0,0,10">
                            <Button Content="إضافة حساب / خزنة" Width="200" Height="35" Click="AddAccount_Click" Margin="5"/>
                            <Button Content="تعديل" Width="100" Height="35" Click="EditAccount_Click" Margin="5"/>
                            <Button Content="حذف" Width="100" Height="35" Click="DeleteAccount_Click" Margin="5"/>
                        </StackPanel>
                        <DataGrid x:Name="AccountsDataGrid" AutoGenerateColumns="False" CanUserAddRows="False" IsReadOnly="True" Height="300">
                            <DataGrid.Columns>
                                <DataGridTextColumn Header="اسم الحساب" Binding="{Binding Name}" Width="*"/>
                                <DataGridTextColumn Header="النوع" Binding="{Binding Type}" Width="*"/>
                                <DataGridTextColumn Header="الرصيد الابتدائي" Binding="{Binding OpeningBalance}" Width="*"/>
                                <DataGridTextColumn Header="الوصف" Binding="{Binding Description}" Width="*"/>
                            </DataGrid.Columns>
                        </DataGrid>
                        <Button Content="حفظ إعدادات الحسابات والخزنة" Width="250" Height="35" Background="#4CAF50" Foreground="White" Margin="0,10,0,0" Click="SaveAccountsSettings_Click"/>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>

        </TabControl>
    </Grid>
</Window>
